# git-lab-telegram-bot

java -Dspring.profiles.active=prod -jar git-lab-telegram-bot-1.0-SNAPSHOT.jar

Бизнес процессы для взаимодействия с GitLab.

1. Отправка уведомления об открытии нового МРа
    1. При создании МРа
    2. При восстановлении старого МРа
2. Редактирование сообщения в чате при внесении изменений в МР
3. Удаление сообщения после закрытия МРа
    1. При закрытии МРа
    2. При сливании мра
4. Отправка реакции к сообщению если был поставлен аппрув на МРе
5. Удалении реакции если апрув был убран
6. Запрет на отправку сообщения если МР имеет статус draft

Бизнес процессы управления ботом через телеграмм.

1. Добавление чатов для которых пользователь хочет осуществлять уведомление.
2. Удаление чатов
3. Реализация связи учетных записей в телеграмме и GitLab.

Для тестирования.

1. При добавлении чата сохраняем данные в chats
   insert into chats(id, type, title)
   values (-1002018570984, '2', 'TestBotChanel');
2. Начало личной переписки с ботом
   insert into tg_users (id, first_name, last_name, username)
   values (586815794, 'Boris', 'Tyutin', 'btyutin');

Запуск на сервере https://timeweb.cloud/

1. screen -ls - список запушенных виртуальных терминалов
2. создание нового скрина
3. Запуск бота
java -Dspring.profiles.active=prod -jar git-lab-telegram-bot-1.1.1-SNAPSHOT.jar

4. Выйти из в терминала ctrl + a d

Подключение Webhooks GitLab
1. Для получения оповешьений о MR
http://83.222.10.198:9000/liga-bot/merges/requests
2. Для сохранения истории pipeline (Нужно для истьории, что бы постороить модель)
http://83.222.10.198:9000/liga-bot/pipelines/histories

Подключение к H2 бд на сервере
 
http://83.222.10.198:9000/liga-bot/h2-console